,Text,Metadata
0,"('page_content', '# Study design {#data-design}\n\n```{r}\n#| include: false\nsource(""_common.R"")\n```\n\n::: {.chapterintro data-latex=""""}\nBefore digging into the details of working with data, we stop to think about how data come to be.\nThat is, if the data are to be used to make broad and complete conclusions, then it is important to understand who or what the data represent.\nOne important aspect of data provenance is sampling.\nKnowing how the observational units were selected from a larger entity will allow for generalizations back to the population from which the data were randomly selected.\nAdditionally, by understanding the structure of the study, causal relationships can be separated from those relationships which are only associated.\nA good question to ask oneself before working with the data at all is, ""How were these observations collected?"".\nYou will learn a lot about the data by understanding its source.\n:::\n\n## Sampling principles and strategies {#sampling-principles-strategies}\n\nThe first step in conducting research is to identify topics or questions that are to be investigated.\nA clearly laid out research question is helpful in identifying what subjects or cases should be studied and what variables are important.\nIt is also important to consider *how* data are collected so that the data are reliable and help achieve the research goals.\n\n### Populations and samples\n\nConsider the following three research questions:\n\n1.  What is the average mercury content in swordfish in the Atlantic Ocean?\n2.  Over the last five years, what is the average time to complete a degree for Duke undergrads?\n3.  Does a new drug reduce the number of deaths in patients with severe heart disease?\n\nEach research question refers to a target **population**.\nIn the first question, the target population is all swordfish in the Atlantic Ocean, and each fish represents a case.\nOftentimes, it is not feasible to collect data for every case in a population.\nCollecting data for an entire population is called a **census**.\nA census is difficult because it is too expensive to collect data for the entire population, but it might also be because it is difficult or impossible to identify the entire population of interest!\nInstead, a sample is taken.\nA **sample** is the data you have.\nIdeally, a sample is a small fraction of the population.\nFor instance, 60 swordfish (or some other number) in the population might be selected, and this sample data may be used to provide an estimate of the population average and to answer the research question.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(""population"", ""census"", ""sample"")\n```\n\n::: {.guidedpractice data-latex=""""}\nFor the second and third questions above, identify the target population and what represents an individual case.[^02-data-design-1]\n:::\n\n[^02-data-design-1]: The question *""Over the last five years, what is the average time to complete a degree for Duke undergrads?""* is only relevant to students who complete their degree; the average cannot be computed using a student who never finished their degree.\n    Thus, only Duke undergrads who graduated in the last five years represent cases in the population under consideration.\n    Each such student is an individual case.\n    For the question *""Does a new drug reduce the number of deaths in patients with severe heart disease?""*, a person with severe heart disease represents a case.\n    The population includes all people with severe heart disease.\n\n### Parameters and statistics\n\nIn most statistical analysis procedures, the research question at hand boils down to understanding a numerical summary.\nThe number (or set of numbers) may be a quantity you are already familiar with (like the average) or it may be something you learn through this text (like the slope and intercept from a least squares model, provided in Section \\@ref(least-squares-regression)).\n\nA numerical summary can be calculated on either the sample of observations or the entire population.\nHowever, measuring every unit in the population is usually prohibitive (so the parameter is very rarely calculated).\nSo, a ""typical"" numerical summary is calculated from a sample.\nYet, we can still conceptualize calculating the average income of all adults in Argentina.\n\nWe use specific terms in order to differentiate when a number is being calculated on a sample of data (**statistic**) and when it is being calculated or considered for calculation on the entire population (**parameter**).\nThe terms statistic and parameter are useful for communicating claims and models and will be used extensively in later chapters which delve into making inference on populations.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""parameter"", ""statistic"")\n```\n\n### Anecdotal evidence\n\n\\index{bias}\n\nConsider the following possible responses to the three research questions:\n\n1.  A man on the news got mercury poisoning from eating swordfish, so the average mercury concentration in swordfish must be dangerously high.\n2.  I met two students who took more than 7 years to graduate from Duke, so it must take longer to graduate at Duke than at many other colleges.\n3.  My friend\'s dad had a heart attack and died after they gave him a new heart disease drug, so the drug must not work.\n\nEach conclusion is based on data.\nHowever, there are two problems.\nFirst, the data only represent one or two cases.\nSecond, and more importantly, it is unclear whether these cases are actually representative of the population.\nData collected in this haphazard fashion are called **anecdotal evidence**.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""anecdotal evidence"")\n```\n\n::: {.important data-latex=""""}\n**Anecdotal evidence.**\n\nBe careful of data collected in a haphazard fashion.\nSuch evidence may be true and verifiable, but it may only represent extraordinary cases and therefore not be a good representation of the population.\n:::\n\n```{r}\n#| label: mn-winter\n#| out.width: 35%\n#| fig-cap: In February 2010, some media pundits cited one large snowstorm as evidence\n#|   against global warming. As comedian Jon Stewart pointed out, ""It is one storm, in\n#|   one region of one country.""\n#| fig-alt: Photograph shows a city street covered in snow and ice.\ninclude_graphics(""images/mn-winter/mn-winter.jpg"")\n```\n\nAnecdotal evidence typically is composed of unusual cases that we recall based on their striking characteristics.\nFor instance, we are more likely to remember the two people we met who took 7 years to graduate than the six others who graduated in four years.\nInstead, of looking at the most unusual cases, we should examine a sample of many cases that better represent the population.\n\n### Sampling from a population\n\n\\index{random sample} \\index{bias}\n\nWe might try to estimate the time to graduation for Duke undergraduates in the last five years by collecting a sample of graduates.\nAll graduates in the last five years represent the *population*\\index{population}, and graduates who are selected for review are collectively called the *sample*\\index{sample}.\nIn general, we always seek to *randomly* select a sample from a population.\nThe most basic type of random selection is equivalent to how raffles are conducted.\nFor example, in selecting graduates, we could write each graduate\'s name on a raffle ticket and draw 10 tickets.\nThe selected names would represent a random sample of 10 graduates.\n\n```{r}\n#| label: pop-to-sample\n#| fig-cap: In this graphic, 10 graduates are randomly selected from the population to\n#|   be included in the sample.\n#| fig-asp: 0.5\n#| fig-width: 8.0\n#| fig-alt: A large circle contains many dots which indicate all the graduates. A smaller\n#|   circle contains a few of the dots (i.e., graduates) which have been randomly selected\n#|   from the larger circle.\n#| out.width: 70%\nset.seed(1234)\npar_og <- par(no.readonly = TRUE) # save original par\npar(mar = rep(0, 4))\nplot(c(0, 2), c(0, 1.1), type = ""n"", axes = FALSE, xlab = """", ylab = """")\ntemp <- seq(0, 2 * pi, 2 * pi / 100)\nx <- 0.5 + 0.5 * cos(temp)\ny <- 0.5 + 0.5 * sin(temp)\nlines(x, y)\n\ns <- matrix(runif(1000), ncol = 2)\nS <- matrix(NA, 350, 2)\nj <- 0\nfor (i in 1:nrow(s)) {\n  if (sum((s[i, ] - 0.5)^2) < 0.23) {\n    j <- j + 1\n    S[j, ] <- s[i, ]\n  }\n}\npoints(S, col = IMSCOL[""blue"", ""f2""], pch = 20)\ntext(0.5, 1, ""all graduates"", pos = 3, cex = 1.3)\n\nset.seed(50)\nN <- sample(j, 25)\nlines((x - 0.5) / 2 + 1.5, (y - 0.5) / 2 + 0.5, pch = 20)\n\nSS <- (S[N, ] - 0.5) / 2 + 0.5\nthese <- c(2, 5, 10, 12, 20, 21, 22, 23, 1, 8)\npoints(SS[these, 1] + 1, SS[these, 2], col = IMSCOL[""red"", ""f1""], pch = 20, cex = 1.5)\ntext(1.5, 0.75, ""sample"", pos = 3, cex = 1.3)\n\nfor (i in these) {\n  arrows(S[N[i], 1], S[N[i], 2],\n    SS[i, 1] + 1 - 0.03, SS[i, 2],\n    length = 0.08, col = IMSCOL[""black"", ""full""], lwd = 1.5\n  )\n}\npar(par_og) # restore original par\n```\n\n::: {.workedexample data-latex=""""}\nSuppose we ask a student who happens to be majoring in nutrition to select several graduates for the study.\nWhat kind of students do you think they might collect?\nDo you think their sample would be representative of all graduates?\n\n------------------------------------------------------------------------\n\nPerhaps they would pick a disproportionate number of graduates from health-related fields.\nOr perhaps their selection would be a good representation of the population.\nWhen selecting samples by hand, we run the risk of picking a **biased** sample, even if our bias is unintended.\n:::\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""sample bias"")\n```\n\n```{r}\n#| label: pop-to-sub-sample-graduates\n#| fig-cap: Asked to pick a sample of graduates, a nutrition major might inadvertently\n#|   pick a disproportionate number of graduates from health-related majors.\n#| fig-asp: 0.5\n#| fig-width: 8.0\n#| fig-alt: A large circle contains many dots which indicate all the graduates, but some\n#|   of the dots have been greyed out where others are dark dots from which the sample\n#|   is taken.  A smaller circle contains a few of the dots (i.e., graduates) which have\n#|   been selected from the biased group of dark dots in the large circle.\n#| out.width: 70%\npar_og <- par(no.readonly = TRUE) # save original par\npar(mar = rep(0, 4))\nplot(c(0, 2), c(0, 1.1), type = ""n"", axes = FALSE, xlab = """", ylab = """")\ntemp <- seq(0, 2 * pi, 2 * pi / 100)\nx <- 0.5 + 0.5 * cos(temp)\ny <- 0.5 + 0.5 * sin(temp)\nlines(x, y)\n\ns <- matrix(runif(1000), ncol = 2)\nS <- matrix(NA, 350, 2)\nj <- 0\nsub <- rep(FALSE, 1000)\nfor (i in 1:nrow(s)) {\n  if (sum((s[i, ] - 0.5)^2) < 0.23) {\n    j <- j + 1\n    S[j, ] <- s[i, ]\n  }\n  if (sum((s[i, ] - c(0.05, 0.18) - 0.5)^2) < 0.07) {\n    sub[j] <- TRUE\n  }\n}\npoints(S, col = IMSCOL[""blue"", 4 - 2 * sub], pch = 20)\ntext(0.5, 1, ""all graduates"", pos = 3, cex = 1.3)\nlines(\n  (x - 0.5) * 2 * sqrt(0.07) + 0.55,\n  (y - 0.5) * 2 * sqrt(0.07) + 0.68\n)\n\nset.seed(7)\nN <- sample((1:j)[sub], 25)\nlines((x - 0.5) / 2 + 1.5,\n  (y - 0.5) / 2 + 0.5,\n  pch = 20\n)\n\nSS <- (S[N, ] - 0.5) / 2 + 0.5\nthese <- c(2, 5, 10, 12, 20, 21, 22, 23, 1, 8)\npoints(SS[these, 1] + 1, SS[these, 2], col = IMSCOL[""red"", ""f1""], pch = 20, cex = 1.5)\ntext(1.5, 0.75, ""sample"", pos = 3, cex = 1.3)\n\nfor (i in these) {\n  arrows(S[N[i], 1], S[N[i], 2],\n    SS[i, 1] + 1 - 0.03, SS[i, 2],\n    length = 0.08,\n    col = IMSCOL[""black"", ""full""],\n    lwd = 1.5\n  )\n}\nrect(0.143, 0.2, 0.952, 0.301,\n  border = ""#00000000"",\n  col = ""#FFFFFF88""\n)\nrect(0.236, 0.301, 0.858, 0.403,\n  border = ""#00000000"",\n  col = ""#FFFFFF88""\n)\ntext(0.55, 0.5 + 0.18 - sqrt(0.07),\n  ""graduates from\\nhealth-related fields"",\n  pos = 1, cex = 1.3\n)\npar(par_og) # restore original par\n```\n\nIf someone was permitted to pick and choose exactly which graduates were included in the sample, it is entirely possible that the sample would overrepresent that person\'s interests, which may be entirely unintentional.\nThis introduces **bias** into a sample.\nSampling randomly helps address this problem.\nThe most basic random sample is called a **simple random sample** and is equivalent to drawing names out of a hat to select cases.\nThis means that each case in the population has an equal chance of being included and the cases in the sample are not related to each other.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""bias"", ""simple random sample"")\n```\n\nThe act of taking a simple random sample helps minimize bias.\nHowever, bias can crop up in other ways.\nEven when people are picked at random, e.g., for surveys, caution must be exercised if the **non-response rate**\\index{non-response rate} is high.\nFor instance, if only 30% of the people randomly sampled for a survey actually respond, then it is unclear whether the results are **representative** of the entire population.\nThis **non-response bias**\\index{non-response bias} can skew results.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""non-response rate"", ""representative"", ""non-response bias"")\n```\n\n```{r}\n#| label: survey-sample\n#| fig-cap: Due to the possibility of non-response, survey studies may only reach a certain\n#|   group within the population. It is difficult, and oftentimes impossible, to completely\n#|   fix this problem.\n#| fig-asp: 0.5\n#| fig-width: 8.0\n#| fig-alt: A large circle contains many dots which indicate the population of interest,\n#|   but some of the dots have been greyed out where others are dark dots from which\n#|   the sample is taken (where the grey dots are potentially due to non-response bias).  A\n#|   smaller circle contains a few of the dots which have been selected from the group\n#|   of dark dots in the large circle who were individuals willing to respond to the\n#|   survey.\n#| out.width: 70%\npar_og <- par(no.readonly = TRUE) # save original par\npar(mar = rep(0, 4))\nplot(c(0, 2),\n     c(0, 1.1),\n     type=\'n\',\n     axes=FALSE,\n     xlab="""",\n     ylab="""")\ntemp <- seq(0, 2 * pi, 2 * pi / 100)\nx <- 0.5 + 0.5 * cos(temp)\ny <- 0.5 + 0.5 * sin(temp)\nlines(x, y)\n\ns <- matrix(runif(700), ncol = 2)\nS <- matrix(NA, 350, 2)\nj <- 0\nsub <- rep(FALSE, 1000)\nfor (i in 1:nrow(s)) {\n  if (sum((s[i,] - 0.5)^2) < 0.23) {\n    j <- j + 1\n    S[j, ] <- s[i, ]\n  }\n  if (sum((s[i, ] - c(-0.15, 0.05) - 0.5)^2) < 0.115) {\n    sub[j] <- TRUE\n  }\n}\npoints(S, col = IMSCOL[""blue"", 4 - 2 * sub], pch = 20)\ntext(0.5, 1, \'population of interest\', pos = 3, cex = 1.3)\nlines((x - 0.5) * 2 * sqrt(0.115) + 0.35,\n      (y - 0.5) * 2 * sqrt(0.115) + 0.55)\n\nset.seed(7)\nN <- sample((1:j)[sub], 25)\nlines((x - 0.5) / 2 + 1.5,\n      (y - 0.5) / 2 + 0.5,\n      pch=20)\n\nSS <- (S[N, ] - 0.5) / 2 + 0.5\nthese <- c(2, 5, 6, 7, 15)\npoints(SS[these, 1] + 1,\n       SS[these, 2],\n       col = IMSCOL[""red"", ""f1""],\n       pch = 20,\n       cex = 1.5)\ntext(1.5, 0.75, \'sample\', pos=3, cex = 1.3)\n\nfor(i in these){\n\tarrows(S[N[i], 1],\n\t       S[N[i], 2],\n\t       SS[i, 1] + 1 - 0.03,\n\t       SS[i, 2],\n\t       length=0.08,\n\t       col=IMSCOL[""black"", ""full""],\n\t       lwd=1.5)\n}\nrect(0.145, 0.195, 0.775, 0.11,\n     border=""#00000000"",\n     col=""#FFFFFF88"")\nrect(0.31, 0.018, 0.605, 0.11,\n     border=""#00000000"",\n     col=""#FFFFFF88"")\ntext(0.46, 0.5 + 0.06 - sqrt(0.115),\n     \'population actually\\nsampled\',\n     pos=1,\n     cex=1)\npar(par_og) # restore original par\n```\n\nAnother common downfall is a **convenience sample**\\index{convenience sample}, where individuals who are easily accessible are more likely to be included in the sample.\nFor instance, if a political survey is done by stopping people walking in the Bronx, this will not represent all of New York City.\nIt is often difficult to discern what sub-population a convenience sample represents.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""convenience sample"")\n```\n\n::: {.guidedpractice data-latex=""""}\nWe can easily access ratings for products, sellers, and companies through websites.\nThese ratings are based only on those people who go out of their way to provide a rating.\nIf 50% of online reviews for a product are negative, do you think this means that 50% of buyers are dissatisfied with the product?\nWhy or why not?[^02-data-design-2]\n:::\n\n[^02-data-design-2]: Answers will vary.\n    From our own anecdotal experiences, we believe people tend to rant more about products that fell below expectations than rave about those that perform as expected.\n    For this reason, we suspect there is a negative bias in product ratings on sites like Amazon.\n    However, since our experiences may not be representative, we also keep an open mind.\n\n\\index{random sample} \\index{bias} \\index{population} \\index{sample}\n\n### Four sampling methods {#samp-methods}\n\nAlmost all statistical methods are based on the notion of implied randomness.\nIf data are not collected in a random framework from a population, these statistical methods -- the estimates and errors associated with the estimates -- are not reliable.\nHere we consider four random sampling techniques: simple, stratified, cluster, and multistage sampling.\nFigures @fig-simple-stratified and @fig-cluster-multistage provide graphical representations of these techniques.\n\n\\index{simple random sampling} \\index{stratified sampling}\n\n```{r}\n#| label: fig-simple-stratified\n#| fig-cap: \'Examples of simple random and stratified sampling. In the top panel, simple\n#|   random sampling was used to randomly select the 18 cases (denoted in red). In the\n#|   bottom panel, stratified sampling was used: cases were first grouped into strata,\n#|   then simple random sampling was employed to randomly select 3 cases within each\n#|   stratum.\'\n#| fig-width: 10.0\n#| out.width: 100%\n#| fig-alt: The top box shows a population of dots (i.e., individuals) where a handful\n#|   of the dots have been sampled randomly.  The bottom box shows the same population\n#|   of dots but grouped in such a way that there are six strata.  From each stratum\n#|   three dots (i.e., individuals) are randomly selected.\n\nsource(""helpers/helper-sampling.R"")   # source helper\npar_og <- par(no.readonly = TRUE)     # save original par\npar(mar = rep(0.5,4), mfrow = c(2,1)) # no margin, 2 figures \nbuild_srs(n = 18, N = 108)            # build figure\nbuild_stratified(N = 108)             # build figure\npar(par_og)                           # restore original par\n```\n\n**Simple random sampling** is probably the most intuitive form of random sampling.\nConsider the salaries of Major League Baseball (MLB) players, where each player is a member of one of the league\'s 30 teams.\nTo take a simple random sample of 120 baseball players and their salaries, we could write the names of that season\'s several hundreds of players onto slips of paper, drop the slips into a bucket, shake the bucket around until we are sure the names are all mixed up, then draw out slips until we have the sample of 120 players.\nIn general, a sample is referred to as ""simple random"" if each case in the population has an equal chance of being included in the final sample *and* knowing that a case is included in a sample does not provide useful information about which other cases are included.\n\n\\index{strata}\n\n**Stratified sampling** is a divide-and-conquer sampling strategy.\nThe population is divided into groups called **strata**.\nThe strata are chosen so that similar cases are grouped together, then a second sampling method, usually simple random sampling, is employed within each stratum.\nIn the baseball salary example, each of the 30 teams could represent a stratum, since some teams have a lot more money (up to 4 times as much!).\nThen we might randomly sample 4 players from each team for our sample of 120 players.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""simple random sampling"", ""stratified sampling"", ""strata"")\n```\n\n**Stratified sampling** is especially useful when the cases in each stratum are very similar with respect to the outcome of interest.\nThe downside is that analyzing data from a stratified sample is a more complex task than analyzing data from a simple random sample.\nThe analysis methods introduced in this book would need to be extended to analyze data collected using stratified sampling.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""stratified sampling"")\n```\n\n::: {.workedexample data-latex=""""}\nWhy would it be good for cases within each stratum to be very similar?\n\n------------------------------------------------------------------------\n\nWe might get a more stable estimate for the subpopulation in a stratum if the cases are very similar, leading to more precise estimates within each group.\nWhen we combine these estimates into a single estimate for the full population, that population estimate will tend to be more precise since each individual group estimate is itself more precise.\n:::\n\nIn a **cluster sample**, we break up the population into many groups, called **clusters**.\nThen we sample a fixed number of clusters and include all observations from each of those clusters in the sample.\nA **multistage sample** is like a cluster sample, but rather than keeping all observations in each cluster, we would collect a random sample within each selected cluster.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""cluster sampling"", ""cluster"", ""multistage sample"")\n```\n\n\\index{cluster sampling}\n\n```{r}\n#| label: fig-cluster-multistage\n#| fig-cap: \'Examples of cluster and multistage sampling. In the top panel, cluster sampling\n#|   was used: data were binned into nine clusters, three of these clusters were sampled,\n#|   and all observations within these three clusters were included in the sample. In\n#|   the bottom panel, multistage sampling was used, which differs from cluster sampling\n#|   only in that we randomly select a subset of each cluster to be included in the sample\n#|   rather than measuring every case in each sampled cluster.\'\n#| fig-width: 10.0\n#| out.width: 100%\n#| fig-alt: In the top figure, dots are grouped into clusters, three clusters are selected,\n#|   and every dot (i.e., all individuals) from each of the three clusters are sampled.  In\n#|   the bottom figure, dots are again grouped into clusters and three clusters are selected.  However,\n#|   random sampling is applied so that a random sample from each of the three selected\n#|   clusters is taken.\n\nsource(""helpers/helper-sampling.R"")   # source helper\npar_og <- par(no.readonly = TRUE)     # save original par\npar(mar = rep(0.5,4), mfrow = c(2,1)) # no margin, 2 figures \nbuild_cluster()                       # build figure\nbuild_multistage()                    # build figure\npar(par_og)                           # restore original par\n```\n\nSometimes cluster or multistage sampling can be more economical than the alternative sampling techniques.\nAlso, unlike stratified sampling, these approaches are most helpful when there is a lot of case-to-case variability within a cluster but the clusters themselves do not look very different from one another.\nFor example, if neighborhoods represented clusters, then cluster or multistage sampling work best when the populations inside each neighborhood are very diverse.\nA downside of these methods is that more advanced techniques are typically required to analyze the data, though the methods in this book can be extended to handle such data.\n\n::: {.workedexample data-latex=""""}\nSuppose we are interested in estimating the malaria rate in a densely tropical portion of rural Indonesia.\nWe learn that there are 30 villages in that part of the Indonesian jungle, each more or less like the next, but the distances between the villages are substantial.\nOur goal is to test 150 individuals for malaria.\nWhat sampling method should be employed?\n\n------------------------------------------------------------------------\n\nA simple random sample would likely draw individuals from all 30 villages, which could make data collection extremely expensive.\nStratified sampling would be a challenge since it is unclear how we would build strata of similar individuals.\nHowever, cluster sampling or multistage sampling seem like very good ideas.\nIf we decided to use multistage sampling, we might randomly select half of the villages, then randomly select 10 people from each.\nThis would probably reduce our data collection costs substantially in comparison to a simple random sample, and the cluster sample would still give us reliable information, even if we would need to analyze the data with slightly more advanced methods than we discuss in this book.\n:::\n\n\\clearpage\n\n## Experiments\n\nStudies where the researchers assign treatments to cases are called **experiments**.\nWhen this assignment includes randomization, e.g., using a coin flip to decide which treatment a patient receives, it is called a **randomized experiment**.\nRandomized experiments are fundamentally important when trying to show a causal connection between two variables.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""experiment"", ""randomized experiment"")\n```\n\n### Principles of experimental design\n\n1.  **Controlling.** Researchers assign treatments to cases, and they do their best to **control** any other differences in the groups[^02-data-design-3]. For example, when patients take a drug in pill form, some patients take the pill with only a sip of water while others may have it with an entire glass of water. To control for the effect of water consumption, a doctor may instruct every patient to drink a 12-ounce glass of water with the pill.\n\n[^02-data-design-3]: This is a different concept than a *control group*, which we discuss in the second principle and in Section \\@ref(reducing-bias-human-experiments).\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""control"")\n```\n\n2.  **Randomization.** Researchers randomize patients into treatment groups to account for variables that cannot be controlled.\n    For example, some patients may be more susceptible to a disease than others due to their dietary habits.\n    In this example dietary habit is a **confounding variable**[^02-data-design-4], which is defined as a variable that is associated with both the explanatory and response variables.\n    Randomizing patients into the treatment or control group helps even out such differences.\n\n    ```{r}\n    #| include: false\n    terms_chp_2 <- c(terms_chp_2, ""confounding variable"")\n    ```\n\n3.  **Replication.** The more cases researchers observe, the more accurately they can estimate the effect of the explanatory variable on the response.\n    In a single study, we **replicate** by collecting a sufficiently large sample.\n    What is considered sufficiently large varies from experiment to experiment, but at a minimum we want to have multiple subjects (experimental units) per treatment group.\n    Another way of achieving replication is replicating an entire study to verify an earlier finding.\n    The term **replication crisis** refers to the ongoing methodological crisis in which past findings from scientific studies in several disciplines have failed to be replicated.\n    **Pseudoreplication** occurs when individual observations under different treatments are heavily dependent on each other.\n    For example, suppose you have 50 subjects in an experiment where you\'re taking blood pressure measurements at 10 time points throughout the course of the study.\n    By the end, you will have 50 $\\times$ 10 = 500 measurements.\n    Reporting that you have 500 observations would be considered pseudoreplication, as the blood pressure measurements of a given individual are not independent of each other.\n    Pseudoreplication often happens when the wrong entity is replicated, and the reported sample sizes are exaggerated.\n\n[^02-data-design-4]: Also called a **lurking variable**, **confounding factor**, or a **confounder**.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""replication"", ""pseudoreplication"", ""replication crisis"")\n```\n\n4.  **Blocking.** Researchers sometimes know or suspect that variables, other than the treatment, influence the response. Under these circumstances, they may first group individuals based on this variable into **blocks** and then randomize cases within each block to the treatment groups. This strategy is often referred to as **blocking**. For instance, if we are looking at the effect of a drug on heart attacks, we might first split patients in the study into low-risk and high-risk blocks, then randomly assign half the patients from each block to the control group and the other half to the treatment group, as shown in @fig-blocking. This strategy ensures that each treatment group has the same number of low-risk patients and the same number of high-risk patients.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""blocking"")\n```\n\n```{r}\n#| label: fig-blocking\n#| fig-cap: Blocking using a variable depicting patient risk. Patients are first divided\n#|   into low-risk and high-risk blocks, then each block is evenly separated into the\n#|   treatment groups using randomization. This strategy ensures an equal representation\n#|   of patients in each treatment group from both the low-risk and high-risk categories.\n#| warning: false\n#| fig-width: 6.0\n#| fig-asp: 1.0\n#| fig-alt: Before randomly allocating, the red low risk patients and blue high risk\n#|   patients are split into two separate groups. Subsequently, half of the red low risk\n#|   patients are randomly chosen to receive the treatment, and half of the blue high\n#|   risk patients are randomly chosen to receive the treatment.\n#| out.width: 100%\n\nset.seed(12345)\nsource(""helpers/helper-blocking.R"") # source helper\npar_og <- par(no.readonly = TRUE)   # save original par\npar(mar = rep(0,4))                 # no margins\nbuild_blocking()                    # build figure\npar(par_og)                         # restore original par\n```\n\nIt is important to incorporate the first three experimental design principles into any study, and this book describes applicable methods for analyzing data from such experiments.\nBlocking is a slightly more advanced technique, and statistical methods in this book may be extended to analyze data collected using blocking.\n\n\\clearpage\n\n### Reducing bias in human experiments {#reducing-bias-human-experiments}\n\nRandomized experiments have long been considered to be the gold standard for data collection, but they do not ensure an unbiased perspective into the cause-and-effect relationship in all cases.\nHuman studies are perfect examples where bias can unintentionally arise.\nHere we reconsider a study where a new drug was used to treat heart attack patients.\nIn particular, researchers wanted to know if the drug reduced deaths in patients.\n\nThese researchers designed a randomized experiment because they wanted to draw causal conclusions about the drug\'s effect.\nStudy volunteers[^02-data-design-5] were randomly placed into two study groups.\nOne group, the **treatment group**, received the drug.\nThe other group, called the **control group**, did not receive any drug treatment.\n\n[^02-data-design-5]: Human subjects are often called **patients**, **volunteers**, or **study participants**.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""treatment group"", ""control group"")\n```\n\nPut yourself in the place of a person in the study.\nIf you are in the treatment group, you are given a fancy new drug that you anticipate will help you.\nOn the other hand, a person in the other group does not receive the drug and sits idly, hoping her participation does not increase her risk of death.\nThese perspectives suggest there are actually two effects in this study: the one of interest is the effectiveness of the drug, and the second is an emotional effect of (not) taking the drug, which is difficult to quantify.\n\nResearchers aren\'t usually interested in the emotional effect, which might bias the study.\nTo circumvent this problem, researchers do not want patients to know which group they are in.\nWhen researchers keep the patients uninformed about their treatment, the study is said to be **blind**.\nBut there is one problem: if a patient does not receive a treatment, they will know they\'re in the control group.\nA solution to this problem is to give a fake treatment to patients in the control group.\nThis is called a **placebo**, and an effective placebo is the key to making a study truly blind.\nA classic example of a placebo is a sugar pill that is made to look like the actual treatment pill.\nHowever, offering such a fake treatment may not be ethical in certain experiments.\nFor example, in medical experiments, typically the control group must get the current standard of care.\nOftentimes, a placebo results in a slight but real improvement in patients.\nThis effect has been dubbed the **placebo effect**.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""blind"", ""placebo"", ""placebo effect"")\n```\n\nThe patients are not the only ones who should be blinded: doctors and researchers can unintentionally bias a study.\nWhen a doctor knows a patient has been given the real treatment, they might inadvertently give that patient more attention or care than a patient that they know is on the placebo.\nTo guard against this bias, which again has been found to have a measurable effect in some instances, most modern studies employ a **double-blind** setup where doctors or researchers who interact with patients are, just like the patients, unaware of who is or is not receiving the treatment.[^02-data-design-6]\n\n[^02-data-design-6]: There are always some researchers involved in the study who do know which patients are receiving which treatment.\n    However, they do not interact with the study\'s patients and do not tell the blinded health care professionals who is receiving which treatment.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""double-blind"")\n```\n\n::: {.guidedpractice data-latex=""""}\nLook back to the study in Section \\@ref(case-study-stents-strokes) where researchers were testing whether stents were effective at reducing strokes in at-risk patients.\nIs this an experiment?\nWas the study blinded?\nWas it double-blinded?[^02-data-design-7]\n:::\n\n[^02-data-design-7]: The researchers assigned the patients into their treatment groups, so this study was an experiment.\n    However, the patients could distinguish what treatment they received because a stent is a surgical procedure.\n    There is no equivalent surgical placebo, so this study was not blind.\n    The study could not be double-blind since it was not blind.\n\n::: {.guidedpractice data-latex=""""}\nFor the study in Section \\@ref(case-study-stents-strokes), could the researchers have employed a placebo?\nIf so, what would that placebo have looked like?[^02-data-design-8]\n:::\n\n[^02-data-design-8]: Ultimately, can we make patients think they got treated from a surgery?\n    In fact, we can, and some experiments use a **sham surgery**.\n    In a sham surgery, the patient does undergo surgery, but the patient does not receive the full treatment, though they will still get a placebo effect.\n\nYou may have many questions about the ethics of sham surgeries to create a placebo.\nThese questions may have even arisen in your mind when in the general experiment context, where a possibly helpful treatment was withheld from individuals in the control group; the main difference is that a sham surgery tends to create additional risk, while withholding a treatment only maintains a person\'s risk.\n\nThere are always multiple viewpoints of experiments and placebos, and rarely is it obvious which is ethically ""correct"".\nFor instance, is it ethical to use a sham surgery when it creates a risk to the patient?\nHowever, if we do not use sham surgeries, we may promote the use of a costly treatment that has no real effect; if this happens, money and other resources will be diverted away from other treatments that are known to be helpful.\nUltimately, this is a difficult situation where we cannot perfectly protect both the patients who have volunteered for the study and the patients who may benefit (or not) from the treatment in the future.\n\n## Observational studies\n\nData where no treatment has been explicitly applied (or explicitly withheld) is called **observational data**.\nFor instance, the loan data and county data described in Section \\@ref(data-basics) are both examples of observational data.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""observational data"")\n```\n\nMaking causal conclusions based on experiments is often reasonable, since we can randomly assign the explanatory variable(s), i.e., the treatments.\nHowever, making the same causal conclusions based on observational data can be treacherous and is not recommended.\nThus, observational studies are generally only sufficient to show associations or form hypotheses that can be later checked with experiments.\n\n::: {.guidedpractice data-latex=""""}\nSuppose an observational study tracked sunscreen use and skin cancer, and it was found that the more sunscreen someone used, the more likely the person was to have skin cancer.\nDoes this mean sunscreen *causes* skin cancer?[^02-data-design-9]\n:::\n\n[^02-data-design-9]: No.\n    See the paragraph following the question!\n\nSome previous research tells us that using sunscreen actually reduces skin cancer risk, so maybe there is another variable that can explain this hypothetical association between sunscreen usage and skin cancer.\nOne important piece of information that is absent is sun exposure.\nIf someone is out in the sun all day, they are more likely to use sunscreen *and* more likely to get skin cancer.\nExposure to the sun is unaccounted for in the simple observational investigation.\n\n```{r}\n#| label: sun-causes-cancer\n#| fig-asp: 0.4\n#| fig-alt: \'Three boxes are shown in a triangle arrangement representing: sun exposure,\n#|   using sunscreen, and skin cancer.  A solid arrow connects sun exposure as a causal\n#|   mechanism to using sunscreen; a solid arrow also connects sun exposure as a causal\n#|   mechanism to skin cancer.  A questioning arrow indicates that the causal effect\n#|   of using sunscreen on skin cancer is unknown.\'\n#| out.width: 60%\npar_og <- par(no.readonly = TRUE) # save original par\npar(mar = rep(0, 4))\nplot(c(-0.05, 1.2),\n     c(0.39, 1),\n     type = \'n\',\n     axes = FALSE)\ntext(0.59, 0.89, \'sun exposure\', cex = 1)\nrect(0.4, 0.8, 0.78, 1)\ntext(0.3, 0.49, \'use sunscreen\', cex = 1)\nrect(0.1, 0.4, 0.48, 0.6)\narrows(0.49, 0.78, 0.38, 0.62,\n       length = 0.08, lwd = 1.5)\ntext(0.87, 0.5, \'skin cancer\', cex = 1)\nrect(0.71,0.4, 1.01, 0.6)\narrows(0.67, 0.78, 0.8, 0.62,\n       length = 0.08, lwd = 1.5)\n\narrows(0.5, 0.5, 0.69, 0.5,\n       length = 0.08, col = IMSCOL[""gray"", ""f1""])\ntext(0.595, 0.565, ""?"",\n     cex = 1.5, col = IMSCOL[""gray"", ""full""])\npar(par_og) # restore original par\n```\n\nIn this example, sun exposure is a confounding variable.\nThe presence of confounding variables is what inhibits the ability for observational studies to make causal claims.\nWhile one method to justify making causal conclusions from observational studies is to exhaust the search for confounding variables, there is no guarantee that all confounding variables can be examined or measured.\n\n::: {.guidedpractice data-latex=""""}\n@fig-county-multi-unit-homeownership shows a negative association between the homeownership rate and the percentage of housing units that are in multi-unit structures in a county.\nHowever, it is unreasonable to conclude that there is a causal relationship between the two variables.\nSuggest a variable that might explain the negative relationship.[^02-data-design-10]\n:::\n\n[^02-data-design-10]: Answers will vary.\n    Population density may be important.\n    If a county is very dense, then this may require a larger percentage of residents to live in housing units that are in multi-unit structures.\n    Additionally, the high density may contribute to increases in property value, making homeownership unfeasible for many residents.\n\nObservational studies come in two forms: prospective and retrospective studies.\nA **prospective study** identifies individuals and collects information as events unfold.\nFor instance, medical researchers may identify and follow a group of patients over many years to assess the possible influences of behavior on cancer risk.\nOne example of such a study is The Nurses\' Health Study.\nStarted in 1976 and expanded in 1989, the Nurses\' Health Study has collected data on over 275,000 nurses and is still enrolling participants.\nThis prospective study recruits registered nurses and then collects data from them using questionnaires.\n**Retrospective studies** collect data after events have taken place, e.g., researchers may review past events in medical records.\nSome datasets may contain both prospectively- and retrospectively collected variables, such as medical studies which gather information on participants\' lives before they enter the study and subsequently collect data on participants throughout the study.\n\n```{r}\n#| include: false\nterms_chp_2 <- c(terms_chp_2, ""prospective study"", ""retrospective study"")\n```\n\n\\clearpage\n\n## Chapter review {#chp2-review}\n\n### Summary\n\nA strong analyst will have a good sense of the types of data they are working with and how to visualize the data in order to gain a complete understanding of the variables.\nEqually important however, is an understanding of the data source.\nIn this chapter, we have discussed randomized experiments and taking good, random, representative samples from a population.\nWhen we discuss inferential methods (starting in Chapter \\@ref(foundations-randomization)), the conclusions that can be drawn will be dependent on how the data were collected.\n@fig-randsampValloc summarizes the differences between random assignment of treatments and random samples.[^02-data-design-11]\nRegularly revisiting @fig-randsampValloc will be important when making conclusions from a given data analysis.\n\n[^02-data-design-11]: Derived from similar figures in @ISCAM and @sleuth.\n\n```{r}\n#| label: fig-randsampValloc\n#| out.width: 100%\n#| fig-cap: As we will see, analysis conclusions should be made carefully according to\n#|   how the data were collected.  Note that very few datasets come from the top left\n#|   box because usually ethics require that random assignment of treatments can only\n#|   be given to volunteers. Both representative (ideally random) sampling and experiments\n#|   (random assignment of treatments) are important for how statistical conclusions\n#|   can be made on populations.\nknitr::include_graphics(""images/randsampValloc.png"")\n```\n\n### Terms\n\nWe introduced the following terms in the chapter.\nIf you\'re not sure what some of these terms mean, we recommend you go back in the text and review their definitions.\nWe are purposefully presenting them in alphabetical order, instead of in order of appearance, so they will be a little more challenging to locate.\nHowever, you should be able to easily spot them as **bolded text**.\n\n```{r}\nmake_terms_table(terms_chp_2)\n```\n\n\\clearpage\n\n## Exercises {#chp2-exercises}\n\nAnswers to odd numbered exercises can be found in Appendix \\@ref(exercise-solutions-02).\n\n::: {.exercises data-latex=""""}\n{{< include exercises/_02-ex-data-design.qmd >}}\n:::\n')","('metadata', {'source': 'https://raw.githubusercontent.com/OpenIntroStat/ims/main/02-data-design.qmd'})"
